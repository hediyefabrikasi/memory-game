<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>üíñ Fotoƒüraf E≈üle≈ütirme Oyunu</title>
  <style>
    :root {
      --bg: #fff0f5;
      --card: #ffffff;
      --accent: #ff5fa2;
      --text: #333;
    }

    body {
      margin: 0;
      font-family: "Poppins", system-ui, sans-serif;
      background: linear-gradient(135deg, var(--bg), #ffe4ef);
      color: var(--text);
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .app {
      width: 100%;
      max-width: 430px;
      padding: 16px;
      box-sizing: border-box;
    }

    header {
      text-align: center;
      margin-bottom: 12px;
    }

    h1 {
      font-size: 1.4rem;
      margin: 4px 0;
    }

    .sub {
      font-size: 0.85rem;
      opacity: 0.8;
    }

    .top-bar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin: 8px 0 12px;
      gap: 8px;
      flex-wrap: wrap;
    }

    .pill {
      background: var(--card);
      border-radius: 999px;
      padding: 6px 12px;
      font-size: 0.75rem;
      box-shadow: 0 4px 12px rgba(0,0,0,0.06);
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .pill button {
      border: none;
      background: transparent;
      font-size: 0.8rem;
      cursor: pointer;
    }

    .game {
      background: var(--card);
      border-radius: 18px;
      padding: 12px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.08);
    }

    .level-title {
      text-align: center;
      font-weight: 600;
      margin-bottom: 6px;
    }

    .level-message {
      text-align: center;
      font-size: 0.85rem;
      margin-bottom: 10px;
      opacity: 0.9;
    }

    .grid {
      display: grid;
      gap: 8px;
    }

    .card {
      position: relative;
      width: 100%;
      aspect-ratio: 1 / 1;
      border-radius: 14px;
      perspective: 800px;
      cursor: pointer;
    }

    .card-inner {
      position: absolute;
      inset: 0;
      border-radius: 14px;
      transition: transform 0.5s;
      transform-style: preserve-3d;
    }

    .card.flipped .card-inner {
      transform: rotateY(180deg);
    }

    .card-face {
      position: absolute;
      inset: 0;
      border-radius: 14px;
      backface-visibility: hidden;
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
    }

    .card-front {
      background: linear-gradient(135deg, #ff9acb, #ff5fa2);
      color: white;
      font-size: 1.8rem;
    }

    .card-back {
      transform: rotateY(180deg);
      background: #000;
    }

    .card-back img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .controls {
      margin-top: 12px;
      display: flex;
      gap: 8px;
      justify-content: center;
      flex-wrap: wrap;
    }

    .btn {
      border: none;
      border-radius: 999px;
      padding: 10px 16px;
      font-size: 0.85rem;
      font-weight: 600;
      cursor: pointer;
      background: linear-gradient(135deg, #ff7eb3, #ff4f9a);
      color: white;
      box-shadow: 0 6px 16px rgba(255,79,154,0.3);
    }

    .btn.secondary {
      background: #eee;
      color: #333;
      box-shadow: none;
    }

    .overlay {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.45);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 50;
    }

    .modal {
      background: white;
      border-radius: 20px;
      padding: 20px;
      width: 90%;
      max-width: 360px;
      text-align: center;
      box-shadow: 0 20px 50px rgba(0,0,0,0.25);
    }

    .modal h2 {
      margin-top: 0;
    }

    .stars {
      font-size: 1.4rem;
      margin: 6px 0 10px;
    }

    .hidden {
      display: none;
    }

    /* HEART BURST */
    .heart {
      position: fixed;
      width: 16px;
      height: 16px;
      background: #ff4f9a;
      transform: rotate(45deg);
      animation: pop 900ms ease-out forwards;
      z-index: 999;
    }

    .heart::before,
    .heart::after {
      content: "";
      position: absolute;
      width: 16px;
      height: 16px;
      background: #ff4f9a;
      border-radius: 50%;
    }

    .heart::before {
      top: -8px;
      left: 0;
    }

    .heart::after {
      left: -8px;
      top: 0;
    }

    @keyframes pop {
      0% { transform: translate(0,0) scale(1) rotate(45deg); opacity: 1; }
      100% { transform: translate(var(--dx), var(--dy)) scale(0) rotate(45deg); opacity: 0; }
    }

    /* THEMES */
    body.theme-dark {
      --bg: #0f172a;
      --card: #111827;
      --accent: #38bdf8;
      --text: #e5e7eb;
      background: linear-gradient(135deg, #020617, #0f172a);
    }

    body.theme-pastel {
      --bg: #fdf2f8;
      --card: #ffffff;
      --accent: #f472b6;
      --text: #374151;
      background: linear-gradient(135deg, #fdf2f8, #fce7f3);
    }

    body.theme-romantic {
      --bg: #fff0f5;
      --card: #ffffff;
      --accent: #ff5fa2;
      --text: #3f3f46;
      background: linear-gradient(135deg, #ffe4ef, #fff0f5);
    }

    body.theme-neon {
      --bg: #020617;
      --card: #020617;
      --accent: #22d3ee;
      --text: #e0f2fe;
      background: radial-gradient(circle at top, #0ea5e9, #020617 60%);
    }

    /* MOBILE GRID TUNING */
    @media (max-width: 420px) {
      .grid {
        gap: 6px;
      }
      h1 { font-size: 1.25rem; }
      .pill { font-size: 0.7rem; }
    }
  </style>
</head>
<body class="theme-romantic">
  <div class="app">
    <header>
      <h1 id="title">üíñ Ay≈üe i√ßin Hafƒ±za Oyunu</h1>
      <div class="sub">Sevgilim beni ne kadar iyi tanƒ±yor?</div>
    </header>

    <div class="top-bar">
      <div class="pill">‚è± <span id="timer">00:00</span></div>
      <div class="pill">‚≠ê <span id="stars">0</span></div>
      <div class="pill">üèÜ En iyi s√ºre: <span id="bestTime">--:--</span></div>
      <div class="pill">
        üé® Tema
        <button onclick="cycleTheme()">Deƒüi≈ütir</button>
      </div>
      <div class="pill">
        üîä <button id="soundToggle">A√ßƒ±k</button>
      </div>
    </div>

    <div class="game">
      <div class="level-title" id="levelTitle">Level 1</div>
      <div class="level-message" id="levelMessage"></div>
      <div class="grid" id="grid"></div>
    </div>

    <div class="controls">
      <button class="btn secondary" onclick="restartGame()">Ba≈ütan Ba≈üla</button>
    </div>
  </div>

  <!-- LEVEL START MODAL -->
  <div class="overlay" id="levelOverlay">
    <div class="modal">
      <h2 id="overlayTitle">Level 1</h2>
      <p id="overlayMessage"></p>
      <button class="btn" onclick="startLevel()">Ba≈üla üíñ</button>
    </div>
  </div>

  <!-- FINISH MODAL -->
  <div class="overlay hidden" id="finishOverlay">
    <div class="modal">
      <h2>üéâ Harikasƒ±n!</h2>
      <p id="finishText"></p>
      <div class="stars" id="finishStars"></div>
      <button class="btn" onclick="restartGame()">Tekrar Oyna üíï</button>
    </div>
  </div>

  <!-- AUDIOS -->
  <audio id="flipSound" src="audios/flip.mp3" preload="auto"></audio>
  <audio id="matchSound" src="audios/match.mp3" preload="auto"></audio>
  <audio id="wrongSound" src="audios/wrong.mp3" preload="auto"></audio>
  <audio id="levelSound" src="audios/level.mp3" preload="auto"></audio>

  <script>
    /*********************
     * CONFIG ‚Äì MANUEL D√úZENLE
     *********************/

    const customerName = "Ay≈üe"; // üëâ M√º≈üteri adƒ±

    // M√º≈üterinin g√∂nderdiƒüi fotoƒüraflar (en az 10 adet √∂nerilir)
    const allImages = [
      "images/1.jpg",
      "images/2.jpg",
      "images/3.jpg",
      "images/4.jpg",
      "images/5.jpg",
      "images/6.jpg",
      "images/7.jpg",
      "images/8.jpg",
      "images/9.jpg",
      "images/10.jpg",
      "images/11.jpg",
      "images/12.jpg",
      "images/13.jpg",
      "images/14.jpg",
      "images/15.jpg",
    ];

    // Level kart sayƒ±larƒ±
    const levels = [
      { count: 6, message: "Ba≈ülƒ±yoruz " + customerName + " üòç Kolay ƒ±sƒ±nma turu!" },
      { count: 12, message: "Hmm zorla≈üƒ±yor üíï Bakalƒ±m dikkatini toplayabilecek misin?" },
      { count: 16, message: "Ciddi ili≈üki seviyesi üòè Kalbinle oyna!" },
      { count: 20, message: "Final turu üíñ Eƒüer bunu ba≈üarƒ±rsan seni √ßok seviyorum!" },
    ];

    const romanticWrongMessages = [
      "Ayy olmadƒ± üòÖ Ama seni yine de seviyorum!",
      "Kalbim biraz kƒ±rƒ±ldƒ± üíî Ama bir √∂p√ºc√ºkle ge√ßer üòò",
      "Yanlƒ±≈ü e≈üle≈ütirme! Ama a≈ükƒ±mƒ±z doƒüru üíï",
      "Bu deƒüildi üò≠ Ama yine dene a≈ükƒ±m!",
      "Hmm olmadƒ±‚Ä¶ Bir sarƒ±lma ister misin? ü§ó",
    ];

    /*********************
     * STATE
     *********************/

    let levelIndex = 0;
    let cards = [];
    let firstCard = null;
    let lock = false;
    let matchedPairs = 0;

    let timer = 0;
    let timerInterval = null;

    let soundOn = true;

    const bestTimeKey = "memoryGameBestTime";

    /*********************
     * ELEMENTS
     *********************/

    const titleEl = document.getElementById("title");
    const gridEl = document.getElementById("grid");
    const timerEl = document.getElementById("timer");
    const starsEl = document.getElementById("stars");
    const bestTimeEl = document.getElementById("bestTime");

    const levelOverlay = document.getElementById("levelOverlay");
    const overlayTitle = document.getElementById("overlayTitle");
    const overlayMessage = document.getElementById("overlayMessage");

    const finishOverlay = document.getElementById("finishOverlay");
    const finishText = document.getElementById("finishText");
    const finishStars = document.getElementById("finishStars");

    const flipSound = document.getElementById("flipSound");
    const matchSound = document.getElementById("matchSound");
    const wrongSound = document.getElementById("wrongSound");
    const levelSound = document.getElementById("levelSound");

    const soundToggleBtn = document.getElementById("soundToggle");

    /*********************
     * INIT
     *********************/

    titleEl.textContent = `üíñ ${customerName} i√ßin Hafƒ±za Oyunu`;

    const savedBest = localStorage.getItem(bestTimeKey);
    if (savedBest) bestTimeEl.textContent = formatTime(parseInt(savedBest));

    showLevelOverlay();

    /*********************
     * GAME FLOW
     *********************/

    function showLevelOverlay() {
      const level = levels[levelIndex];
      overlayTitle.textContent = `Level ${levelIndex + 1}`;
      overlayMessage.textContent = level.message;
      levelOverlay.classList.remove("hidden");
    }

    function startLevel() {
      levelOverlay.classList.add("hidden");
      buildLevel();
      startTimer();
      playSound(levelSound);
    }

    function buildLevel() {
      const level = levels[levelIndex];
      const pairCount = level.count / 2;

      matchedPairs = 0;
      firstCard = null;
      lock = false;

      document.getElementById("levelTitle").textContent = `Level ${levelIndex + 1}`;
      document.getElementById("levelMessage").textContent = level.message;

      // Grid columns responsive
      const cols = Math.min(5, Math.ceil(Math.sqrt(level.count)));
      gridEl.style.gridTemplateColumns = `repeat(${cols}, 1fr)`;

      // Random images
      const selected = shuffle([...allImages]).slice(0, pairCount);
      const deck = shuffle([...selected, ...selected]);

      gridEl.innerHTML = "";
      cards = [];

      deck.forEach((imgSrc, index) => {
        const card = document.createElement("div");
        card.className = "card";
        card.dataset.image = imgSrc;

        const inner = document.createElement("div");
        inner.className = "card-inner";

        const front = document.createElement("div");
        front.className = "card-face card-front";
        front.textContent = "üíñ";

        const back = document.createElement("div");
        back.className = "card-face card-back";
        const img = document.createElement("img");
        img.src = imgSrc;
        back.appendChild(img);

        inner.appendChild(front);
        inner.appendChild(back);
        card.appendChild(inner);

        card.addEventListener("click", () => onCardClick(card));

        gridEl.appendChild(card);
        cards.push(card);
      });
    }

    function onCardClick(card) {
      if (lock || card.classList.contains("flipped") || card.classList.contains("matched")) return;

      playSound(flipSound);
      card.classList.add("flipped");

      if (!firstCard) {
        firstCard = card;
        return;
      }

      const secondCard = card;
      lock = true;

      if (firstCard.dataset.image === secondCard.dataset.image) {
        // MATCH
        setTimeout(() => {
          firstCard.classList.add("matched");
          secondCard.classList.add("matched");
          matchedPairs++;

          heartBurst(secondCard);
          playSound(matchSound);

          resetTurn();

          if (matchedPairs === cards.length / 2) {
            onLevelComplete();
          }
        }, 350);
      } else {
        // WRONG
        setTimeout(() => {
          playSound(wrongSound);
          showRomanticWrong();
          firstCard.classList.remove("flipped");
          secondCard.classList.remove("flipped");
          resetTurn();
        }, 700);
      }
    }

    function resetTurn() {
      [firstCard, lock] = [null, false];
    }

    function onLevelComplete() {
      stopTimer();

      // Stars by time (lower is better)
      const levelStars = calculateStars(timer);
      starsEl.textContent = parseInt(starsEl.textContent) + levelStars;

      if (levelIndex < levels.length - 1) {
        levelIndex++;
        setTimeout(() => showLevelOverlay(), 800);
      } else {
        onGameComplete();
      }
    }

    function onGameComplete() {
      stopTimer();

      const totalTime = timer;
      const totalStars = starsEl.textContent;

      // Best time save
      const best = localStorage.getItem(bestTimeKey);
      if (!best || totalTime < parseInt(best)) {
        localStorage.setItem(bestTimeKey, totalTime);
        bestTimeEl.textContent = formatTime(totalTime);
      }

      finishText.textContent = `${customerName}, oyunu ${formatTime(totalTime)} s√ºrede bitirdin üíñ`;
      finishStars.textContent = "‚≠ê".repeat(Math.min(5, Math.floor(totalStars / 3)) || 1);
      finishOverlay.classList.remove("hidden");
    }

    function restartGame() {
      stopTimer();
      levelIndex = 0;
      timer = 0;
      timerEl.textContent = "00:00";
      starsEl.textContent = "0";
      finishOverlay.classList.add("hidden");
      showLevelOverlay();
    }

    /*********************
     * TIMER
     *********************/

    function startTimer() {
      stopTimer();
      timer = 0;
      timerEl.textContent = "00:00";
      timerInterval = setInterval(() => {
        timer++;
        timerEl.textContent = formatTime(timer);
      }, 1000);
    }

    function stopTimer() {
      if (timerInterval) clearInterval(timerInterval);
      timerInterval = null;
    }

    function formatTime(seconds) {
      const m = String(Math.floor(seconds / 60)).padStart(2, "0");
      const s = String(seconds % 60).padStart(2, "0");
      return `${m}:${s}`;
    }

    /*********************
     * STARS
     *********************/

    function calculateStars(time) {
      if (time <= 20) return 3;
      if (time <= 35) return 2;
      return 1;
    }

    /*********************
     * THEMES
     *********************/

    const themes = ["theme-romantic", "theme-dark", "theme-pastel", "theme-neon"];
    let themeIndex = 0;

    function cycleTheme() {
      document.body.classList.remove(themes[themeIndex]);
      themeIndex = (themeIndex + 1) % themes.length;
      document.body.classList.add(themes[themeIndex]);
    }

    /*********************
     * SOUND
     *********************/

    soundToggleBtn.addEventListener("click", () => {
      soundOn = !soundOn;
      soundToggleBtn.textContent = soundOn ? "A√ßƒ±k" : "Kapalƒ±";
    });

    function playSound(audio) {
      if (!soundOn) return;
      audio.currentTime = 0;
      audio.play();
    }

    /*********************
     * HEART BURST
     *********************/

    function heartBurst(card) {
      const rect = card.getBoundingClientRect();
      const x = rect.left + rect.width / 2;
      const y = rect.top + rect.height / 2;

      for (let i = 0; i < 12; i++) {
        const heart = document.createElement("div");
        heart.className = "heart";
        heart.style.left = x + "px";
        heart.style.top = y + "px";

        const dx = (Math.random() - 0.5) * 120 + "px";
        const dy = (Math.random() - 0.5) * 120 + "px";
        heart.style.setProperty("--dx", dx);
        heart.style.setProperty("--dy", dy);

        document.body.appendChild(heart);
        setTimeout(() => heart.remove(), 900);
      }
    }

    /*********************
     * ROMANTIC WRONG MESSAGE
     *********************/

    function showRomanticWrong() {
      const msg = romanticWrongMessages[Math.floor(Math.random() * romanticWrongMessages.length)];
      toast(msg);
    }

    function toast(text) {
      const el = document.createElement("div");
      el.textContent = text;
      el.style.position = "fixed";
      el.style.bottom = "24px";
      el.style.left = "50%";
      el.style.transform = "translateX(-50%)";
      el.style.background = "rgba(0,0,0,0.7)";
      el.style.color = "white";
      el.style.padding = "10px 14px";
      el.style.borderRadius = "999px";
      el.style.fontSize = "0.8rem";
      el.style.zIndex = "999";
      el.style.opacity = "0";
      el.style.transition = "opacity 200ms ease";

      document.body.appendChild(el);
      requestAnimationFrame(() => (el.style.opacity = "1"));
      setTimeout(() => {
        el.style.opacity = "0";
        setTimeout(() => el.remove(), 300);
      }, 1600);
    }

    /*********************
     * UTIL
     *********************/

    function shuffle(arr) {
      for (let i = arr.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [arr[i], arr[j]] = [arr[j], arr[i]];
      }
      return arr;
    }
  </script>
</body>
</html>
